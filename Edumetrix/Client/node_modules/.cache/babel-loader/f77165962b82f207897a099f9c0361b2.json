{"ast":null,"code":"!function (t, e) {\n  \"object\" == typeof exports && \"object\" == typeof module ? module.exports = e() : \"function\" == typeof define && define.amd ? define([], e) : \"object\" == typeof exports ? exports.Compress = e() : t.Compress = e();\n}(this, function () {\n  return function (t) {\n    function e(i) {\n      if (n[i]) return n[i].exports;\n      var a = n[i] = {\n        exports: {},\n        id: i,\n        loaded: !1\n      };\n      return t[i].call(a.exports, a, a.exports, e), a.loaded = !0, a.exports;\n    }\n\n    var n = {};\n    return e.m = t, e.c = n, e.p = \"\", e(0);\n  }([function (t, e, n) {\n    var i, a, r;\n    !function (o, u) {\n      a = [t, n(1), n(2), n(3), n(4), n(5), n(6)], i = u, r = \"function\" == typeof i ? i.apply(e, a) : i, !(void 0 !== r && (t.exports = r));\n    }(this, function (t, e, n, i, a, r, o) {\n      \"use strict\";\n\n      function u(t) {\n        return t && t.__esModule ? t : {\n          default: t\n        };\n      }\n\n      function s(t) {\n        if (Array.isArray(t)) {\n          for (var e = 0, n = Array(t.length); e < t.length; e++) n[e] = t[e];\n\n          return n;\n        }\n\n        return Array.from(t);\n      }\n\n      function f(t, e) {\n        if (!(t instanceof e)) throw new TypeError(\"Cannot call a class as a function\");\n      }\n\n      var d = u(e),\n          l = u(n),\n          c = u(i),\n          h = u(a),\n          v = u(r),\n          p = u(o),\n          g = function () {\n        function t(t, e) {\n          for (var n = 0; n < e.length; n++) {\n            var i = e[n];\n            i.enumerable = i.enumerable || !1, i.configurable = !0, \"value\" in i && (i.writable = !0), Object.defineProperty(t, i.key, i);\n          }\n        }\n\n        return function (e, n, i) {\n          return n && t(e.prototype, n), i && t(e, i), e;\n        };\n      }(),\n          w = function () {\n        function t() {\n          f(this, t);\n        }\n\n        return g(t, [{\n          key: \"attach\",\n          value: function (t, e) {\n            var n = this;\n            return new Promise(function (i, a) {\n              var r = document.querySelector(t);\n              r.setAttribute(\"accept\", \"image/*\"), r.addEventListener(\"change\", function (t) {\n                var a = n.compress([].concat(s(t.target.files)), e);\n                i(a);\n              }, !1);\n            });\n          }\n        }, {\n          key: \"compress\",\n          value: function (t, e) {\n            function n(t, e) {\n              var n = new v.default(e);\n              return n.start = window.performance.now(), n.alt = t.name, n.ext = t.type, n.startSize = t.size, p.default.orientation(t).then(function (e) {\n                return n.orientation = e, c.default.load(t);\n              }).then(i(n));\n            }\n\n            function i(t) {\n              return function (e) {\n                return h.default.load(e).then(function (e) {\n                  if (t.startWidth = e.naturalWidth, t.startHeight = e.naturalHeight, t.resize) {\n                    var n = h.default.resize(t.maxWidth, t.maxHeight)(e.naturalWidth, e.naturalHeight),\n                        i = n.width,\n                        a = n.height;\n                    t.endWidth = i, t.endHeight = a;\n                  } else t.endWidth = e.naturalWidth, t.endHeight = e.naturalHeight;\n\n                  return l.default.imageToCanvas(t.endWidth, t.endHeight, t.orientation)(e);\n                }).then(function (e) {\n                  return t.iterations = 1, t.base64prefix = d.default.prefix(t.ext), a(e, t.startSize, t.quality, t.size, t.minQuality, t.iterations);\n                }).then(function (e) {\n                  return t.finalSize = d.default.size(e), d.default.data(e);\n                }).then(function (e) {\n                  t.end = window.performance.now();\n                  var n = t.end - t.start;\n                  return {\n                    data: e,\n                    prefix: t.base64prefix,\n                    elapsedTimeInSeconds: n / 1e3,\n                    alt: t.alt,\n                    initialSizeInMb: l.default.size(t.startSize).MB,\n                    endSizeInMb: l.default.size(t.finalSize).MB,\n                    ext: t.ext,\n                    quality: t.quality,\n                    endWidthInPx: t.endWidth,\n                    endHeightInPx: t.endHeight,\n                    initialWidthInPx: t.startWidth,\n                    initialHeightInPx: t.startHeight,\n                    sizeReducedInPercent: (t.startSize - t.finalSize) / t.startSize * 100,\n                    iterations: t.iterations\n                  };\n                });\n              };\n            }\n\n            function a(t, e) {\n              var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1,\n                  i = arguments[3],\n                  r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 1,\n                  o = arguments[5],\n                  u = l.default.canvasToBase64(t, n),\n                  s = d.default.size(u);\n              return o += 1, s > i ? a(t, s, n - .1, i, r, o) : n > r ? a(t, s, n - .1, i, r, o) : n < .5 ? u : u;\n            }\n\n            return Promise.all(t.map(function (t) {\n              return n(t, e);\n            }));\n          }\n        }], [{\n          key: \"convertBase64ToFile\",\n          value: function (t, e) {\n            return l.default.base64ToFile(t, e);\n          }\n        }]), t;\n      }();\n\n      t.exports = w;\n    });\n  }, function (t, e, n) {\n    var i, a, r;\n    !function (n, o) {\n      a = [e], i = o, r = \"function\" == typeof i ? i.apply(e, a) : i, !(void 0 !== r && (t.exports = r));\n    }(this, function (t) {\n      \"use strict\";\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      });\n\n      var e = function (t) {\n        var e = t.replace(/^data:image\\/\\w+;base64,/, \"\").length;\n        return (e - 814) / 1.37;\n      },\n          n = function (t) {\n        return t.split(\";\")[0].match(/jpeg|png|gif/)[0];\n      },\n          i = function (t) {\n        return t.replace(/^data:image\\/\\w+;base64,/, \"\");\n      },\n          a = function (t) {\n        return \"data:\" + t + \";base64,\";\n      };\n\n      t.default = {\n        size: e,\n        mime: n,\n        data: i,\n        prefix: a\n      };\n    });\n  }, function (t, e, n) {\n    var i, a, r;\n    !function (n, o) {\n      a = [e], i = o, r = \"function\" == typeof i ? i.apply(e, a) : i, !(void 0 !== r && (t.exports = r));\n    }(this, function (t) {\n      \"use strict\";\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      });\n\n      var e = function (t) {\n        for (var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : \"image/jpeg\", n = window.atob(t), i = [], a = 0; a < n.length; a++) i[a] = n.charCodeAt(a);\n\n        return new window.Blob([new Uint8Array(i)], {\n          type: e\n        });\n      },\n          n = function (t, e, n) {\n        var i = document.createElement(\"canvas\"),\n            a = i.getContext(\"2d\");\n        return i.width = t, i.height = e, function (r) {\n          if (!n || n > 8) return a.drawImage(r, 0, 0, i.width, i.height), i;\n\n          switch (n > 4 && (i.width = e, i.height = t), n) {\n            case 2:\n              a.translate(t, 0), a.scale(-1, 1);\n              break;\n\n            case 3:\n              a.translate(t, e), a.rotate(Math.PI);\n              break;\n\n            case 4:\n              a.translate(0, e), a.scale(1, -1);\n              break;\n\n            case 5:\n              a.rotate(.5 * Math.PI), a.scale(1, -1);\n              break;\n\n            case 6:\n              a.rotate(.5 * Math.PI), a.translate(0, -e);\n              break;\n\n            case 7:\n              a.rotate(.5 * Math.PI), a.translate(t, -e), a.scale(-1, 1);\n              break;\n\n            case 8:\n              a.rotate(-.5 * Math.PI), a.translate(-t, 0);\n          }\n\n          return n > 4 ? a.drawImage(r, 0, 0, i.height, i.width) : a.drawImage(r, 0, 0, i.width, i.height), i;\n        };\n      },\n          i = function (t) {\n        var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : .75,\n            n = t.toDataURL(\"image/jpeg\", e);\n        return n;\n      },\n          a = function (t) {\n        return {\n          KB: t / 1e3,\n          MB: t / 1e6\n        };\n      };\n\n      t.default = {\n        base64ToFile: e,\n        imageToCanvas: n,\n        canvasToBase64: i,\n        size: a\n      };\n    });\n  }, function (t, e, n) {\n    var i, a, r;\n    !function (n, o) {\n      a = [e], i = o, r = \"function\" == typeof i ? i.apply(e, a) : i, !(void 0 !== r && (t.exports = r));\n    }(this, function (t) {\n      \"use strict\";\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      });\n\n      var e = function (t) {\n        return new Promise(function (e, n) {\n          var i = new window.FileReader();\n          i.addEventListener(\"load\", function (t) {\n            e(t.target.result);\n          }, !1), i.addEventListener(\"error\", function (t) {\n            n(t);\n          }, !1), i.readAsDataURL(t);\n        });\n      };\n\n      t.default = {\n        load: e\n      };\n    });\n  }, function (t, e, n) {\n    var i, a, r;\n    !function (n, o) {\n      a = [e], i = o, r = \"function\" == typeof i ? i.apply(e, a) : i, !(void 0 !== r && (t.exports = r));\n    }(this, function (t) {\n      \"use strict\";\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      });\n\n      var e = function (t) {\n        return new Promise(function (e, n) {\n          var i = new window.Image();\n          i.addEventListener(\"load\", function () {\n            e(i);\n          }, !1), i.addEventListener(\"error\", function (t) {\n            n(t);\n          }, !1), i.src = t;\n        });\n      },\n          n = function (t, e) {\n        return function (n, i) {\n          if (!t && !e) return {\n            width: n,\n            height: i\n          };\n          var a = n / i,\n              r = t / e,\n              o = void 0,\n              u = void 0;\n          return a > r ? (o = Math.min(n, t), u = o / a) : (u = Math.min(i, e), o = u * a), {\n            width: o,\n            height: u\n          };\n        };\n      };\n\n      t.default = {\n        load: e,\n        resize: n\n      };\n    });\n  }, function (t, e, n) {\n    var i, a, r;\n    !function (n, o) {\n      a = [e], i = o, r = \"function\" == typeof i ? i.apply(e, a) : i, !(void 0 !== r && (t.exports = r));\n    }(this, function (t) {\n      \"use strict\";\n\n      function e(t, e) {\n        if (!(t instanceof e)) throw new TypeError(\"Cannot call a class as a function\");\n      }\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      });\n\n      var n = function t(n) {\n        var i = n.quality,\n            a = void 0 === i ? .75 : i,\n            r = n.size,\n            o = void 0 === r ? 2 : r,\n            u = n.maxWidth,\n            s = void 0 === u ? 1920 : u,\n            f = n.maxHeight,\n            d = void 0 === f ? 1920 : f,\n            l = n.resize,\n            c = void 0 === l || l;\n        e(this, t), this.start = window.performance.now(), this.end = null, this.alt = null, this.ext = null, this.startSize = null, this.startWidth = null, this.startHeight = null, this.size = 1e3 * o * 1e3, this.endSize = null, this.endWidth = null, this.endHeight = null, this.iterations = 0, this.base64prefix = null, this.quality = a, this.resize = c, this.maxWidth = s, this.maxHeight = d, this.orientation = 1;\n      };\n\n      t.default = n;\n    });\n  }, function (t, e, n) {\n    var i, a, r;\n    !function (n, o) {\n      a = [e], i = o, r = \"function\" == typeof i ? i.apply(e, a) : i, !(void 0 !== r && (t.exports = r));\n    }(this, function (t) {\n      \"use strict\";\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      });\n\n      var e = function (t) {\n        return new Promise(function (e, n) {\n          var i = new window.FileReader();\n          i.onload = function (t) {\n            var n = new DataView(t.target.result);\n            65496 !== n.getUint16(0, !1) && e(-2);\n\n            for (var i = n.byteLength, a = 2; a < i;) {\n              var r = n.getUint16(a, !1);\n\n              if (a += 2, 65505 === r) {\n                1165519206 !== n.getUint32(a += 2, !1) && e(-1);\n                var o = 18761 === n.getUint16(a += 6, !1);\n                a += n.getUint32(a + 4, o);\n                var u = n.getUint16(a, o);\n                a += 2;\n\n                for (var s = 0; s < u; s++) 274 === n.getUint16(a + 12 * s, o) && e(n.getUint16(a + 12 * s + 8, o));\n              } else {\n                if (65280 !== (65280 & r)) break;\n                a += n.getUint16(a, !1);\n              }\n            }\n\n            e(-1);\n          }, i.readAsArrayBuffer(t.slice(0, 65536));\n        });\n      };\n\n      t.default = {\n        orientation: e\n      };\n    });\n  }]);\n});","map":{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///index.js","webpack:/webpack/bootstrap 5c04cbde4fb824613eb6","webpack:///src/Compress.js","webpack:///src/core/base64.js","webpack:///src/core/converter.js","webpack:///src/core/file.js","webpack:///src/core/image.js","webpack:///src/core/photo.js","webpack:///src/core/rotate.js"],"names":["module","define","exports","root","this","modules","__webpack_require__","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","global","factory","apply","undefined","_base","_converter","_file","_image","_photo","_rotate","_base2","_interopRequireDefault","_converter2","_file2","_image2","_photo2","_rotate2","obj","__esModule","default","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","Compress","value","id","loaded","el","options","Promise","resolve","reject","input","document","querySelector","setAttribute","addEventListener","evt","output","_this","compress","files","compressFile","file","photo","start","window","performance","now","alt","name","ext","type","startSize","size","orientation","then","load","compressImage","src","img","startWidth","naturalWidth","startHeight","naturalHeight","resize","width","height","maxWidth","maxHeight","endWidth","endHeight","imageToCanvas","canvas","iterations","base64prefix","prefix","loopCompression","quality","minQuality","base64","finalSize","data","end","difference","elapsedTimeInSeconds","initialSizeInMb","MB","endSizeInMb","endWidthInPx","endHeightInPx","initialWidthInPx","initialHeightInPx","sizeReducedInPercent","targetSize","targetQuality","base64str","canvasToBase64","newSize","all","map","mime","base64ToFile","len","replace","split","match","arguments","byteString","atob","content","charCodeAt","Blob","Uint8Array","createElement","context","getContext","image","drawImage","translate","scale","rotate","Math","PI","toDataURL","KB","fileReader","FileReader","result","err","readAsDataURL","Image","targetWidth","targetHeight","originalAspectRatio","targetAspectRatio","outputWidth","outputHeight","min","Photo","endSize","reader","onload","event","view","DataView","getUint16","byteLength","offset","marker","getUint32","little","tags","readAsArrayBuffer","slice"],"mappings":"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","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Compress\"] = factory();\n\telse\n\t\troot[\"Compress\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Compress\"] = factory();\n\telse\n\t\troot[\"Compress\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, __webpack_require__(1), __webpack_require__(2), __webpack_require__(3), __webpack_require__(4), __webpack_require__(5), __webpack_require__(6)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(module, require('./core/base64.js'), require('./core/converter.js'), require('./core/file.js'), require('./core/image.js'), require('./core/photo.js'), require('./core/rotate.js'));\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod, global.base64, global.converter, global.file, global.image, global.photo, global.rotate);\n\t    global.Compress = mod.exports;\n\t  }\n\t})(this, function (module, _base, _converter, _file, _image, _photo, _rotate) {\n\t  'use strict';\n\t\n\t  var _base2 = _interopRequireDefault(_base);\n\t\n\t  var _converter2 = _interopRequireDefault(_converter);\n\t\n\t  var _file2 = _interopRequireDefault(_file);\n\t\n\t  var _image2 = _interopRequireDefault(_image);\n\t\n\t  var _photo2 = _interopRequireDefault(_photo);\n\t\n\t  var _rotate2 = _interopRequireDefault(_rotate);\n\t\n\t  function _interopRequireDefault(obj) {\n\t    return obj && obj.__esModule ? obj : {\n\t      default: obj\n\t    };\n\t  }\n\t\n\t  function _toConsumableArray(arr) {\n\t    if (Array.isArray(arr)) {\n\t      for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n\t        arr2[i] = arr[i];\n\t      }\n\t\n\t      return arr2;\n\t    } else {\n\t      return Array.from(arr);\n\t    }\n\t  }\n\t\n\t  function _classCallCheck(instance, Constructor) {\n\t    if (!(instance instanceof Constructor)) {\n\t      throw new TypeError(\"Cannot call a class as a function\");\n\t    }\n\t  }\n\t\n\t  var _createClass = function () {\n\t    function defineProperties(target, props) {\n\t      for (var i = 0; i < props.length; i++) {\n\t        var descriptor = props[i];\n\t        descriptor.enumerable = descriptor.enumerable || false;\n\t        descriptor.configurable = true;\n\t        if (\"value\" in descriptor) descriptor.writable = true;\n\t        Object.defineProperty(target, descriptor.key, descriptor);\n\t      }\n\t    }\n\t\n\t    return function (Constructor, protoProps, staticProps) {\n\t      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n\t      if (staticProps) defineProperties(Constructor, staticProps);\n\t      return Constructor;\n\t    };\n\t  }();\n\t\n\t  var Compress = function () {\n\t    function Compress() {\n\t      _classCallCheck(this, Compress);\n\t    }\n\t\n\t    _createClass(Compress, [{\n\t      key: 'attach',\n\t      value: function attach(el, options) {\n\t        var _this = this;\n\t\n\t        return new Promise(function (resolve, reject) {\n\t          var input = document.querySelector(el);\n\t          input.setAttribute('accept', 'image/*');\n\t          input.addEventListener('change', function (evt) {\n\t            var output = _this.compress([].concat(_toConsumableArray(evt.target.files)), options);\n\t            resolve(output);\n\t          }, false);\n\t        });\n\t      }\n\t    }, {\n\t      key: 'compress',\n\t      value: function compress(files, options) {\n\t        function compressFile(file, options) {\n\t          var photo = new _photo2.default(options);\n\t          photo.start = window.performance.now();\n\t          photo.alt = file.name;\n\t          photo.ext = file.type;\n\t          photo.startSize = file.size;\n\t\n\t          return _rotate2.default.orientation(file).then(function (orientation) {\n\t            photo.orientation = orientation;\n\t            return _file2.default.load(file);\n\t          }).then(compressImage(photo));\n\t        }\n\t        function compressImage(photo) {\n\t          return function (src) {\n\t            return _image2.default.load(src).then(function (img) {\n\t              photo.startWidth = img.naturalWidth;\n\t              photo.startHeight = img.naturalHeight;\n\t\n\t              if (photo.resize) {\n\t                var _Image$resize = _image2.default.resize(photo.maxWidth, photo.maxHeight)(img.naturalWidth, img.naturalHeight),\n\t                    width = _Image$resize.width,\n\t                    height = _Image$resize.height;\n\t\n\t                photo.endWidth = width;\n\t                photo.endHeight = height;\n\t              } else {\n\t                photo.endWidth = img.naturalWidth;\n\t                photo.endHeight = img.naturalHeight;\n\t              }\n\t              return _converter2.default.imageToCanvas(photo.endWidth, photo.endHeight, photo.orientation)(img);\n\t            }).then(function (canvas) {\n\t              photo.iterations = 1;\n\t\n\t              photo.base64prefix = _base2.default.prefix(photo.ext);\n\t              return loopCompression(canvas, photo.startSize, photo.quality, photo.size, photo.minQuality, photo.iterations);\n\t            }).then(function (base64) {\n\t              photo.finalSize = _base2.default.size(base64);\n\t              return _base2.default.data(base64);\n\t            }).then(function (data) {\n\t              photo.end = window.performance.now();\n\t              var difference = photo.end - photo.start;\n\t\n\t              return {\n\t                data: data,\n\t                prefix: photo.base64prefix,\n\t                elapsedTimeInSeconds: difference / 1000,\n\t                alt: photo.alt,\n\t                initialSizeInMb: _converter2.default.size(photo.startSize).MB,\n\t                endSizeInMb: _converter2.default.size(photo.finalSize).MB,\n\t                ext: photo.ext,\n\t                quality: photo.quality,\n\t                endWidthInPx: photo.endWidth,\n\t                endHeightInPx: photo.endHeight,\n\t                initialWidthInPx: photo.startWidth,\n\t                initialHeightInPx: photo.startHeight,\n\t                sizeReducedInPercent: (photo.startSize - photo.finalSize) / photo.startSize * 100,\n\t                iterations: photo.iterations\n\t              };\n\t            });\n\t          };\n\t        }\n\t        function loopCompression(canvas, size) {\n\t          var quality = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\t          var targetSize = arguments[3];\n\t          var targetQuality = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n\t          var iterations = arguments[5];\n\t\n\t          var base64str = _converter2.default.canvasToBase64(canvas, quality);\n\t          var newSize = _base2.default.size(base64str);\n\t\n\t          iterations += 1;\n\t\n\t          if (newSize > targetSize) {\n\t            return loopCompression(canvas, newSize, quality - 0.1, targetSize, targetQuality, iterations);\n\t          }\n\t\n\t          if (quality > targetQuality) {\n\t            return loopCompression(canvas, newSize, quality - 0.1, targetSize, targetQuality, iterations);\n\t          }\n\t\n\t          if (quality < 0.5) {\n\t            return base64str;\n\t          }\n\t          return base64str;\n\t        }\n\t        return Promise.all(files.map(function (file) {\n\t          return compressFile(file, options);\n\t        }));\n\t      }\n\t    }], [{\n\t      key: 'convertBase64ToFile',\n\t      value: function convertBase64ToFile(base64, mime) {\n\t        return _converter2.default.base64ToFile(base64, mime);\n\t      }\n\t    }]);\n\t\n\t    return Compress;\n\t  }();\n\t\n\t  module.exports = Compress;\n\t});\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(exports);\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod.exports);\n\t    global.base64 = mod.exports;\n\t  }\n\t})(this, function (exports) {\n\t  'use strict';\n\t\n\t  Object.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t  });\n\t  var size = function size(base64) {\n\t    var len = base64.replace(/^data:image\\/\\w+;base64,/, '').length;\n\t    return (len - 814) / 1.37;\n\t  };\n\t\n\t  var mime = function mime(base64) {\n\t    return base64.split(';')[0].match(/jpeg|png|gif/)[0];\n\t  };\n\t\n\t  var data = function data(base64) {\n\t    return base64.replace(/^data:image\\/\\w+;base64,/, '');\n\t  };\n\t\n\t  var prefix = function prefix(ext) {\n\t    return 'data:' + ext + ';base64,';\n\t  };\n\t\n\t  exports.default = { size: size, mime: mime, data: data, prefix: prefix };\n\t});\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(exports);\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod.exports);\n\t    global.converter = mod.exports;\n\t  }\n\t})(this, function (exports) {\n\t  'use strict';\n\t\n\t  Object.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t  });\n\t\n\t  var base64ToFile = function base64ToFile(base64) {\n\t    var mime = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'image/jpeg';\n\t\n\t    var byteString = window.atob(base64);\n\t    var content = [];\n\t    for (var i = 0; i < byteString.length; i++) {\n\t      content[i] = byteString.charCodeAt(i);\n\t    }\n\t    return new window.Blob([new Uint8Array(content)], { type: mime });\n\t  };\n\t\n\t  var imageToCanvas = function imageToCanvas(width, height, orientation) {\n\t    var canvas = document.createElement('canvas');\n\t    var context = canvas.getContext('2d');\n\t\n\t    canvas.width = width;\n\t    canvas.height = height;\n\t\n\t\n\t    return function (image) {\n\t      if (!orientation || orientation > 8) {\n\t        context.drawImage(image, 0, 0, canvas.width, canvas.height);\n\t        return canvas;\n\t      }\n\t      if (orientation > 4) {\n\t        canvas.width = height;\n\t        canvas.height = width;\n\t      }\n\t      switch (orientation) {\n\t        case 2:\n\t          context.translate(width, 0);\n\t          context.scale(-1, 1);\n\t          break;\n\t        case 3:\n\t          context.translate(width, height);\n\t          context.rotate(Math.PI);\n\t          break;\n\t        case 4:\n\t          context.translate(0, height);\n\t          context.scale(1, -1);\n\t          break;\n\t        case 5:\n\t          context.rotate(0.5 * Math.PI);\n\t          context.scale(1, -1);\n\t          break;\n\t        case 6:\n\t          context.rotate(0.5 * Math.PI);\n\t          context.translate(0, -height);\n\t          break;\n\t        case 7:\n\t          context.rotate(0.5 * Math.PI);\n\t          context.translate(width, -height);\n\t          context.scale(-1, 1);\n\t          break;\n\t        case 8:\n\t          context.rotate(-0.5 * Math.PI);\n\t          context.translate(-width, 0);\n\t          break;\n\t      }\n\t      if (orientation > 4) {\n\t        context.drawImage(image, 0, 0, canvas.height, canvas.width);\n\t      } else {\n\t        context.drawImage(image, 0, 0, canvas.width, canvas.height);\n\t      }\n\t      return canvas;\n\t    };\n\t  };\n\t\n\t  var canvasToBase64 = function canvasToBase64(canvas) {\n\t    var quality = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0.75;\n\t\n\t    var base64 = canvas.toDataURL('image/jpeg', quality);\n\t    return base64;\n\t  };\n\t\n\t  var size = function size(_size) {\n\t    return {\n\t      KB: _size / 1000,\n\t      MB: _size / (1000 * 1000)\n\t    };\n\t  };\n\t\n\t  exports.default = { base64ToFile: base64ToFile, imageToCanvas: imageToCanvas, canvasToBase64: canvasToBase64, size: size };\n\t});\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(exports);\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod.exports);\n\t    global.file = mod.exports;\n\t  }\n\t})(this, function (exports) {\n\t  'use strict';\n\t\n\t  Object.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t  });\n\t\n\t  var load = function load(file) {\n\t    return new Promise(function (resolve, reject) {\n\t      var fileReader = new window.FileReader();\n\t      fileReader.addEventListener('load', function (evt) {\n\t        resolve(evt.target.result);\n\t      }, false);\n\t\n\t      fileReader.addEventListener('error', function (err) {\n\t        reject(err);\n\t      }, false);\n\t\n\t      fileReader.readAsDataURL(file);\n\t    });\n\t  };\n\t\n\t  exports.default = { load: load };\n\t});\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(exports);\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod.exports);\n\t    global.image = mod.exports;\n\t  }\n\t})(this, function (exports) {\n\t  'use strict';\n\t\n\t  Object.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t  });\n\t\n\t  var load = function load(src) {\n\t    return new Promise(function (resolve, reject) {\n\t      var img = new window.Image();\n\t      img.addEventListener('load', function () {\n\t        resolve(img);\n\t      }, false);\n\t\n\t      img.addEventListener('error', function (err) {\n\t        reject(err);\n\t      }, false);\n\t\n\t      img.src = src;\n\t    });\n\t  };\n\t\n\t  var resize = function resize(targetWidth, targetHeight) {\n\t    return function (width, height) {\n\t      if (!targetWidth && !targetHeight) return { width: width, height: height };\n\t\n\t      var originalAspectRatio = width / height;\n\t      var targetAspectRatio = targetWidth / targetHeight;\n\t\n\t      var outputWidth = void 0,\n\t          outputHeight = void 0;\n\t\n\t      if (originalAspectRatio > targetAspectRatio) {\n\t        outputWidth = Math.min(width, targetWidth);\n\t        outputHeight = outputWidth / originalAspectRatio;\n\t      } else {\n\t        outputHeight = Math.min(height, targetHeight);\n\t        outputWidth = outputHeight * originalAspectRatio;\n\t      }\n\t\n\t      return { width: outputWidth, height: outputHeight };\n\t    };\n\t  };\n\t\n\t  exports.default = { load: load, resize: resize };\n\t});\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(exports);\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod.exports);\n\t    global.photo = mod.exports;\n\t  }\n\t})(this, function (exports) {\n\t  \"use strict\";\n\t\n\t  Object.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t  });\n\t\n\t  function _classCallCheck(instance, Constructor) {\n\t    if (!(instance instanceof Constructor)) {\n\t      throw new TypeError(\"Cannot call a class as a function\");\n\t    }\n\t  }\n\t\n\t  var Photo = function Photo(_ref) {\n\t    var _ref$quality = _ref.quality,\n\t        quality = _ref$quality === undefined ? 0.75 : _ref$quality,\n\t        _ref$size = _ref.size,\n\t        size = _ref$size === undefined ? 2 : _ref$size,\n\t        _ref$maxWidth = _ref.maxWidth,\n\t        maxWidth = _ref$maxWidth === undefined ? 1920 : _ref$maxWidth,\n\t        _ref$maxHeight = _ref.maxHeight,\n\t        maxHeight = _ref$maxHeight === undefined ? 1920 : _ref$maxHeight,\n\t        _ref$resize = _ref.resize,\n\t        resize = _ref$resize === undefined ? true : _ref$resize;\n\t\n\t    _classCallCheck(this, Photo);\n\t\n\t    this.start = window.performance.now();\n\t    this.end = null;\n\t\n\t    this.alt = null;\n\t    this.ext = null;\n\t    this.startSize = null;\n\t    this.startWidth = null;\n\t    this.startHeight = null;\n\t\n\t    this.size = size * 1000 * 1000;\n\t    this.endSize = null;\n\t    this.endWidth = null;\n\t    this.endHeight = null;\n\t    this.iterations = 0;\n\t    this.base64prefix = null;\n\t\n\t    this.quality = quality;\n\t    this.resize = resize;\n\t    this.maxWidth = maxWidth;\n\t    this.maxHeight = maxHeight;\n\t    this.orientation = 1;\n\t  };\n\t\n\t  exports.default = Photo;\n\t});\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(exports);\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod.exports);\n\t    global.rotate = mod.exports;\n\t  }\n\t})(this, function (exports) {\n\t  \"use strict\";\n\t\n\t  Object.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t  });\n\t\n\t\n\t  var orientation = function orientation(file) {\n\t    return new Promise(function (resolve, reject) {\n\t      var reader = new window.FileReader();\n\t\n\t      reader.onload = function (event) {\n\t        var view = new DataView(event.target.result);\n\t\n\t        if (view.getUint16(0, false) !== 0xFFD8) {\n\t          resolve(-2);\n\t        }\n\t        var length = view.byteLength;\n\t        var offset = 2;\n\t\n\t        while (offset < length) {\n\t          var marker = view.getUint16(offset, false);\n\t          offset += 2;\n\t\n\t          if (marker === 0xFFE1) {\n\t            if (view.getUint32(offset += 2, false) !== 0x45786966) {\n\t              resolve(-1);\n\t            }\n\t            var little = view.getUint16(offset += 6, false) === 0x4949;\n\t            offset += view.getUint32(offset + 4, little);\n\t            var tags = view.getUint16(offset, little);\n\t            offset += 2;\n\t\n\t            for (var i = 0; i < tags; i++) {\n\t              if (view.getUint16(offset + i * 12, little) === 0x0112) {\n\t                resolve(view.getUint16(offset + i * 12 + 8, little));\n\t              }\n\t            }\n\t          } else if ((marker & 0xFF00) !== 0xFF00) break;else offset += view.getUint16(offset, false);\n\t        }\n\t        resolve(-1);\n\t      };\n\t      reader.readAsArrayBuffer(file.slice(0, 64 * 1024));\n\t    });\n\t  };\n\t\n\t  exports.default = { orientation: orientation };\n\t});\n\n/***/ })\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// index.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5c04cbde4fb824613eb6","import Base64 from './core/base64.js'\nimport Converter from './core/converter.js'\nimport File from './core/file.js'\nimport Image from './core/image.js'\nimport Photo from './core/photo.js'\nimport Rotate from './core/rotate.js'\n\nclass Compress {\n  attach (el, options) {\n    return new Promise((resolve, reject) => {\n      const input = document.querySelector(el)\n      input.setAttribute('accept', 'image/*')\n      input.addEventListener('change', (evt) => {\n        const output = this.compress([...evt.target.files], options)\n        resolve(output)\n      }, false)\n    })\n  }\n\n  compress (files, options) {\n    function compressFile (file, options) {\n      // Create a new photo object\n      const photo = new Photo(options)\n      photo.start = window.performance.now()\n      photo.alt = file.name\n      photo.ext = file.type\n      photo.startSize = file.size\n\n      return Rotate.orientation(file)\n      .then((orientation) => {\n        photo.orientation = orientation\n        return File.load(file)\n      })\n      .then(compressImage(photo))\n    }\n    function compressImage (photo) {\n      return (src) => {\n        return Image.load(src).then((img) => {\n          // Store the initial dimensions\n          photo.startWidth = img.naturalWidth\n          photo.startHeight = img.naturalHeight\n          // Resize the image\n          if (photo.resize) {\n            const { width, height } = Image.resize(photo.maxWidth, photo.maxHeight)(img.naturalWidth, img.naturalHeight)\n            photo.endWidth = width\n            photo.endHeight = height\n          } else {\n            photo.endWidth = img.naturalWidth\n            photo.endHeight = img.naturalHeight\n          }\n          return Converter.imageToCanvas(photo.endWidth, photo.endHeight, photo.orientation)(img)\n        })\n        .then((canvas) => {\n          photo.iterations = 1\n          // Base64.mime(Converter.canvasToBase64(canvas))\n          photo.base64prefix = Base64.prefix(photo.ext)\n          return loopCompression(canvas, photo.startSize, photo.quality, photo.size, photo.minQuality, photo.iterations)\n        })\n        .then((base64) => {\n          photo.finalSize = Base64.size(base64)\n          return Base64.data(base64)\n        })\n        .then((data) => {\n          photo.end = window.performance.now()\n          const difference = photo.end - photo.start // in ms\n\n          return {\n            data: data,\n            prefix: photo.base64prefix,\n            elapsedTimeInSeconds: difference / 1000, // in seconds\n            alt: photo.alt,\n            initialSizeInMb: Converter.size(photo.startSize).MB,\n            endSizeInMb: Converter.size(photo.finalSize).MB,\n            ext: photo.ext,\n            quality: photo.quality,\n            endWidthInPx: photo.endWidth,\n            endHeightInPx: photo.endHeight,\n            initialWidthInPx: photo.startWidth,\n            initialHeightInPx: photo.startHeight,\n            sizeReducedInPercent: (photo.startSize - photo.finalSize) / photo.startSize * 100,\n            iterations: photo.iterations\n          }\n        })\n      }\n    }\n    function loopCompression (canvas, size, quality = 1, targetSize, targetQuality = 1, iterations) {\n      const base64str = Converter.canvasToBase64(canvas, quality)\n      const newSize = Base64.size(base64str)\n      // const base64str = convertCanvasToBase64(src)\n      // const size = getFileSize(base64str);\n      iterations += 1\n      // add in iteration count\n      if (newSize > targetSize) {\n        return loopCompression(canvas, newSize, quality - 0.1, targetSize, targetQuality, iterations)\n      }\n\n      if (quality > targetQuality) {\n        return loopCompression(canvas, newSize, quality - 0.1, targetSize, targetQuality, iterations)\n      }\n\n      if (quality < 0.5) {\n        return base64str\n      }\n      return base64str\n    }\n    return Promise.all(files.map((file) => {\n      return compressFile(file, options)\n    }))\n  }\n  static convertBase64ToFile (base64, mime) {\n    return Converter.base64ToFile(base64, mime)\n  }\n}\n\n// Supported input formats\n// image/png, image/jpeg, image/jpg, image/gif, image/bmp, image/tiff, image/x-icon,  image/svg+xml, image/webp, image/xxx\n// image/png, image/jpeg, image/webp\nmodule.exports = Compress\n\n\n\n// WEBPACK FOOTER //\n// ./src/Compress.js","const size = (base64) => {\n  const len = base64.replace(/^data:image\\/\\w+;base64,/, '').length\n  return (len - 814) / 1.37\n  // return len * 3 / 4\n}\n\n// strip off the data: url prefix to get just the base64-encoded bytes\n// var data = img.replace(/^data:image\\/\\w+;base64,/, \"\");\nconst mime = (base64) => {\n  return base64.split(';')[0].match(/jpeg|png|gif/)[0]\n}\n\nconst data = (base64) => {\n  return base64.replace(/^data:image\\/\\w+;base64,/, '')\n}\n\nconst prefix = (ext) => {\n  return `data:${ext};base64,`\n}\n\nexport default { size, mime, data, prefix }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/base64.js","\nconst base64ToFile = (base64, mime = 'image/jpeg') => {\n  const byteString = window.atob(base64)\n  const content = []\n  for (let i = 0; i < byteString.length; i++) {\n    content[i] = byteString.charCodeAt(i)\n  }\n  return new window.Blob([new Uint8Array(content)], {type: mime})\n}\n\nconst imageToCanvas = (width, height, orientation) => {\n  const canvas = document.createElement('canvas')\n  const context = canvas.getContext('2d')\n\n  canvas.width = width\n  canvas.height = height\n  // canvas.style.width = width\n  // canvas.style.height = height\n\n  return (image) => {\n    if (!orientation || orientation > 8) {\n      context.drawImage(image, 0, 0, canvas.width, canvas.height)\n      return canvas\n    }\n    if (orientation > 4) {\n      canvas.width = height\n      canvas.height = width\n      // canvas.style.width = height\n      // canvas.style.height = width\n    }\n    switch (orientation) {\n      case 2:\n        // horizontal flip\n        context.translate(width, 0)\n        context.scale(-1, 1)\n        break\n      case 3:\n        // 180 rotate left\n        context.translate(width, height)\n        context.rotate(Math.PI)\n        break\n      case 4:\n        // vertical flip\n        context.translate(0, height)\n        context.scale(1, -1)\n        break\n      case 5:\n        // vertical flip + 90 rotate right\n        context.rotate(0.5 * Math.PI)\n        context.scale(1, -1)\n        break\n      case 6:\n        // 90 rotate right\n        context.rotate(0.5 * Math.PI)\n        context.translate(0, -height)\n        break\n      case 7:\n        // horizontal flip + 90 rotate right\n        context.rotate(0.5 * Math.PI)\n        context.translate(width, -height)\n        context.scale(-1, 1)\n        break\n      case 8:\n        // 90 rotate left\n        context.rotate(-0.5 * Math.PI)\n        context.translate(-width, 0)\n        break\n    }\n    if (orientation > 4) {\n      context.drawImage(image, 0, 0, canvas.height, canvas.width)\n    } else {\n      context.drawImage(image, 0, 0, canvas.width, canvas.height)\n    }\n    return canvas\n  }\n}\n\nconst canvasToBase64 = (canvas, quality = 0.75) => {\n  // in order to compress the final image format has to be jpeg\n  const base64 = canvas.toDataURL('image/jpeg', quality)\n  return base64\n}\n\n// const canvasToImage = (canvas, quality=.75, mimeType='image/jpeg') => {\n//   const image = new Image()\n//   const base64str = canvas.toDataURL(mimeType, quality)\n//   image.src = base64str\n//   return image\n// }\n\nconst size = (size) => {\n  return {\n    KB: size / 1000,\n    MB: size / (1000 * 1000)\n  }\n}\n\nexport default { base64ToFile, imageToCanvas, canvasToBase64, size }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/converter.js","\nconst load = (file) => {\n  return new Promise((resolve, reject) => {\n    const fileReader = new window.FileReader()\n    fileReader.addEventListener('load', (evt) => {\n      resolve(evt.target.result)\n    }, false)\n\n    fileReader.addEventListener('error', (err) => {\n      reject(err)\n    }, false)\n\n    fileReader.readAsDataURL(file)\n  })\n}\n\nexport default { load }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/file.js","\nconst load = (src) => {\n  return new Promise((resolve, reject) => {\n    const img = new window.Image()\n    img.addEventListener('load', () => {\n      resolve(img)\n    }, false)\n\n    img.addEventListener('error', (err) => {\n      reject(err)\n    }, false)\n\n    img.src = src\n  })\n}\n  /*\n   * Resize the image based on the given height or width boundary.\n   * Auto resize based on aspect ratio.\n  **/\nconst resize = (targetWidth, targetHeight) => {\n  return (width, height) => {\n    if (!targetWidth && !targetHeight) return { width, height }\n\n    const originalAspectRatio = width / height\n    const targetAspectRatio = targetWidth / targetHeight\n\n    let outputWidth, outputHeight\n\n    if (originalAspectRatio > targetAspectRatio) {\n      outputWidth = Math.min(width, targetWidth)\n      outputHeight = outputWidth / originalAspectRatio\n    } else {\n      outputHeight = Math.min(height, targetHeight)\n      outputWidth = outputHeight * originalAspectRatio\n    }\n\n    return { width: outputWidth, height: outputHeight }\n  }\n}\n\nexport default { load, resize }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/image.js","// The photo model\nclass Photo {\n  constructor ({ quality = 0.75, size = 2, maxWidth = 1920, maxHeight = 1920, resize = true }) {\n    this.start = window.performance.now()\n    this.end = null\n\n    this.alt = null\n    this.ext = null\n    this.startSize = null\n    this.startWidth = null\n    this.startHeight = null\n    // How much will the quality decrease by each compression\n    // this.stepQuality = stepQuality\n\n    // size in MB\n    this.size = size * 1000 * 1000\n    this.endSize = null\n    this.endWidth = null\n    this.endHeight = null\n    this.iterations = 0\n    this.base64prefix = null\n    // Carry out image resizing\n    this.quality = quality\n    this.resize = resize\n    this.maxWidth = maxWidth\n    this.maxHeight = maxHeight\n    this.orientation = 1\n  }\n}\nexport default Photo\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/photo.js","// https://stackoverflow.com/questions/20600800/js-client-side-exif-orientation-rotate-and-mirror-jpeg-images/31273162#31273162\n\nconst orientation = (file) => {\n  return new Promise((resolve, reject) => {\n    const reader = new window.FileReader()\n\n    reader.onload = function (event) {\n      var view = new DataView(event.target.result)\n\n      if (view.getUint16(0, false) !== 0xFFD8) {\n        resolve(-2)\n      }\n      const length = view.byteLength\n      let offset = 2\n\n      while (offset < length) {\n        const marker = view.getUint16(offset, false)\n        offset += 2\n\n        if (marker === 0xFFE1) {\n          if (view.getUint32(offset += 2, false) !== 0x45786966) {\n            resolve(-1)\n          }\n          const little = view.getUint16(offset += 6, false) === 0x4949\n          offset += view.getUint32(offset + 4, little)\n          const tags = view.getUint16(offset, little)\n          offset += 2\n\n          for (let i = 0; i < tags; i++) {\n            if (view.getUint16(offset + (i * 12), little) === 0x0112) {\n              resolve(view.getUint16(offset + (i * 12) + 8, little))\n            }\n          }\n        } else if ((marker & 0xFF00) !== 0xFF00) break\n        else offset += view.getUint16(offset, false)\n      }\n      resolve(-1)\n    }\n    reader.readAsArrayBuffer(file.slice(0, 64 * 1024))\n  })\n}\n\nexport default { orientation }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/rotate.js"],"sourceRoot":""},"metadata":{},"sourceType":"script"}